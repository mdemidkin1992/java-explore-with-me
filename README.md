## Афиша событий (java-explore-with-me)
Приложение позволяет пользователям размещать события, регистрироваться на участие в них, просматривать списки событий по локациям.
Бэкенд для веб-приложения, разработанный на Java/SpringBoot с использованием Docker, PostgreSQL и Hibernate.

Микросервисная инфраструктура приложения реализована с помощью Docker и docker-compose.yml
- Основной сервис реализован в модуле ```main``` и обрабатывает основную бизнес-логику приложения
- Сервис статистики в модуле ```stats``` собирает статистику по просмотрам пользователями событий 
- У каждого сервиса есть своя ```postgres``` база данных, настроенная в файлах ```application.properties```
___
### Основной функционал ```explore-with-me-main```
API основного сервиса разделите на три части:
- ```public``` доступна без регистрации любому пользователю сети;
- ```private``` доступна только авторизованным пользователям;
- ```admin``` для администраторов сервиса.

**Функционал ```public``` API**
- сортировка списка событий по количеству просмотров либо по датам событий
- просмотр подробной информации о конкретном событии
- получение всех имеющихся категорий и подборок событий
- **запросы для получения списка событий или полной информации о событии фиксируются в сервисе статистики**

**Функционал ```private``` API**
- добавление / изменение / просмотр события 
- подача заявок на участие в интересующих мероприятиях
- создатель мероприятия имеет возможность подтверждать заявки, которые отправили другие пользователи сервиса

**Функционал ```admin``` API**
- добавление / изменение / удаление категорий для событий
- добавление / удаление / закрепление на главной странице подборки мероприятий
- возможность модерации событий, размещённых пользователями, — публикация или отклонение
- добавление / активация / просмотр / удаление пользователей

**Структура базы данных**
- ```User```: пользователи делятся на ```admin```, ```public```, ```private```
- ```Event```: события, которые выставляют зарегистированные ```private``` пользователи
- ```Location```: локации, в которых проиходят события (подробнее см. "Дополнительный функционал")
- ```Category```: категории событий
- ```Compilation```: подборки событий, которые делают администраторы
- ```ParticipationRequest```: запрос на участие в событии, если такая опция включена у события

<img width="873" alt="Screenshot 2023-09-07 at 19 27 13" src="https://github.com/mdemidkin1992/java-explore-with-me/assets/118021621/6ba23e4e-5770-4b92-9038-6ee0f99accb1">


**Http-клиент**

Для отправки запросов на сохранение статистики из сервиса ```main``` в ```stats``` используется ```RestTemplate```.
Класс клиента ```StatsClient``` реализован в отдельном подмодуле ```stats``` и импортирован как зависимость в ```main```. 
___

### Сервис статистики ```explore-with-me-stats```
**Функционал ```stats``` API**
- запись информации о том, что был обработан запрос к эндпоинту API;
- предоставление статистики за выбранные даты по выбранному эндпоинту.
___

#### Дополнительный функционал ```location_processing```

1. Администратор имеет возможность добавлять новые локации ```Location```
2. Зарегистрированные пользователи, выставляя события, указывают его координаты (```lat```, ```lon```):
   - По геопозиции вычисляются ближайшие к событию локации, в радиус которых попадает события (```locationList```)
   - У каждой локации также есть список входящих в нее событий (```eventList```), возникает связь ```many-to-many```
3. Обычные пользователи могут смотреть список ```APPROVED_BY_ADMIN``` локаций и списки ```PUBLISHED``` событий в локациях:
   - Список ```APPROVED_BY_ADMIN``` локаций включает в себя счетчик событий (```events```)
   - Списки событий, которые могут просмотривать пользователи обязаны пройти публикацию администратора

![Untitled](https://github.com/mdemidkin1992/java-explore-with-me/assets/118021621/e41ad2ab-cd7a-4232-b1b1-67df8ae2c545)

#### Добавленные контроллеры
#### Admin
* ```POST /admin/locations```
* ```UPDATE /admin/locations/{id}```
* ```DELETE /admin/locations/{id}```

#### Public
* ```GET /locations``` – получение списка всех одобренных локаций
* ```GET /events/{locationId}/locations``` – получение списка опубликованных событий в локации

#### Обновленная модель данных

Локация как добавляет ее администратор ```Location```: ```name```, ```lat```, ```lon```, ```rad```.

При просмотре списка локаций возвращаем DTO ```LocationDtoWithEventsCount```:
* ```name``` Название локации
* ```events``` Количество событий в локации

Выводятся только одобренные администратором локации со статусом ```APPROVED_BY_ADMIN```.